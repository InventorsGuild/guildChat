<!doctype html>
<html>
  <head>
    <title>Socket.IO Chat</title>
    <style>
	   * {
	      -webkit-padding-start: 0px;
	   }
	   body {
	       margin: 0;
		   padding: 0;
		   font: 13px Helvetica; 
	   }
	
	   #container { 
		  min-width: 1200px;
		  height: 100%;
		  z-index: 10;
	   }
	   #header { 
	       position: relative;
	       height: 60px; 
		   width: 100%;
	       text-align: center;
		   background: #3B5694; 
		   -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.25);
		  -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.25);
		   box-shadow: 0 0 5px rgba(0, 0, 0, 0.25);	
	   }
	   #circle { 
	       left: 60px; 
		   top: 16px; 
	       width: 20px; 
		   height: 20px; 
	       position: absolute;
		   text-align: left; 
		   background: #E60000;
		   -webkit-border-radius: 10px; 
		   -moz-border-radius: 10px; 
		   border-radius: 10px; 
		   border: 2px solid #B20000;		
		   -webkit-box-shadow: 0 0 7px #F00;
		  -moz-box-shadow: 0 0 7px #F00;
		   box-shadow: 0 0 7px #F00;   
	   }
	   #nameBox { 
	       position: relative;
		   -webkit-padding-before: 4px;
	   }
	   #connectText { 
	       margin-bottom: 5px;
		   display: block;
	       color: #FFF;
		   font-size: 95%;
	   }
	   #connectName { 
	        color: #FFF; 
			font-size: 155%;
	   }

	   .noSelect {
		   -webkit-touch-callout: none;
		   -webkit-user-select: none;
		   -khtml-user-select: none;
		   -moz-user-select: none;
		   -ms-user-select: none;
		   user-select: none;
	   }
	   
	   #moreUL {
		  position: relative;
		  top: -25px;
	      left: 40%;
	      text-align: left;
		  display: inline;
		  margin: 0;
		  padding: 10px 4px 12px 0;
		  list-style: none;
		  -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
		  -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
		  box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);		  
	   }
	   
	   #moreLI {
	       font: bold 12px/18px sans-serif;
		   display: inline-block;
		   margin-right: -4px;
		   position: relative;
		   padding: 10px 40px;
		   background: #fff;
		   cursor: pointer;
		   -webkit-transition: all 0.2s;
		   -moz-transition: all 0.2s;
		   -ms-transition: all 0.2s;
		   -o-transition: all 0.2s;
		   transition: all 0.2s;
		   
		   border-radius: 5px 5px 0px 0px;
		   -moz-border-radius: 5px 5px 0px 0px;
		   -webkit-border-radius: 5px 5px 0px 0px;
	   }
	   
	   #moreLI:hover {
		   background: #eee;      
	   }	   
	   #moreLI:active {
	       background: #ccc;
	   }
       
	   
	   #dropDown {
	      text-align: left;
		  display: inline;
		  margin: 0;
		  padding: 10px 4px 12px 0;
		  list-style: none;
		  
		  position: absolute;
		  top: 29px;
		  left: -151px;
		  width: 150px;
		  -webkit-box-shadow: none;
		  -moz-box-shadow: none;
		  box-shadow: none;
		  display: none;	
		  
		  -webkit-transiton: opacity 0.5s;
		  -moz-transition: opacity 0.5s;
		  -ms-transition: opacity 0.5s;
		  -o-transition: opacity 0.5s;
		  -transition: opacity 0.5s;
		  z-index: 40;
	   }
	   
	   #moreDropDown {
	      cursor: default;
	      width: 260px;
		  height: 380px;
	      background: #8196C8;
		  display: block;
		  -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		  -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		  box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
	   }
	   
	   #onlineContainer { 
	      vertical-align: top; 
		  display: inline-box;
	      padding-top: 15px;
	      text-align: center;
	   }
	   
	   #onlineUsersSpan {
	       color: #fff;
		   font-size: 125%; 
		   font-weight: bold;
	   }
	   
	   #onlineUsersScrollable {
	       position: relative;
	       height: 260px;
		   width: 190px;		   
	       overflow-y: auto;
		   overflow-x: hidden;
	       margin-top: 3px; 		
		   left: 12.5%;
		   background: #fff;
		   -webkit-box-shadow: 0 0 3px rgba(0, 0, 0, 0.15);
		   -moz-box-shadow: 0 0 3px rgba(0, 0, 0, 0.15);
		   box-shadow: 0 0 3px rgba(0, 0, 0, 0.15);		   
	   }
	   
	   #onlineUsers {
	       height: 100%;
	       background: #fff;
		   list-style-type: none; 
		   display: block;
	   }
	   
	   #onlineUsers li {
	      position: relative;
		  width: 178px;
	      padding: 3px 6px;
		  left: -40px;
		  -webkit-margin-start: 40px;
		  text-align: left;
		  font-size: 95%;
		  font-style: default;
	   }
	   #onlineUsers li:nth-child(odd) { 
	      background: #eee; 
	   }
	   
	   #settingsButton {
	       font: bold 12px/18px sans-serif;
		   display: inline-block;
		   margin-right: -5px;
		   -webkit-margin-start: 5px;
		   position: relative;
		   padding: 10px 20px;
		   background: #fff;
		   cursor: pointer;	    
		   border: 0;
		   border-radius: 5px; 
		   -moz-border-radius: 5px; 
		   -webkit-border-radius: 5px;
		   -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);	
		   
		   position:relative;
		   left: 130px;
		   top: 20px;
	   }
	   
	   #settingsButton:hover {
		   background: #eee;      
	   }	   
	   #settingsButton:active {
	       background: #ccc;
	   }
	   
	   #shadow {
	       background: #000; 
		   position: fixed; 
		   left: 0; 
		   right: 0; 
		   width: 100%; 
		   height: 100%; 
		   z-index: 42; 
		   display: none; 
		   opacity: 0.7; 
		   filter:progid:DXImageTransform.Microsoft.BasicImage(opacity=.7);
	   }
	   
	   #settingsBox {
	      position: absolute;
	      background: #fff; 
		  left: 50%; 
		  top: 50%; 
		  height: 300px; 
		  width: 400px; 
		  margin-top: -150px; 
		  margin-left: -200px; 
		  display: none; 
		  z-index: 44; 	

		 -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		 -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		  box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);			  
	   }
	   
	   #settingsContainer {
	      vertical-align: top; 
		  text-align: center; 
		  z-index: 45;
		  display: block;
	   }
	   
	   #settingsHeader {
	      position: relative;
		  width: 100%;
		  background: #3B5694;
		  padding-top: 10px; 
		  padding-bottom: 10px;
		  -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		  -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		  box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);	 
	   }
	   
	   #settingsLabel {
	       color: #fff;
	       font-size: 150%;
	   }
	   
	   #nameChangeContainer {
	      padding-top: 40px; 
	      vertical-align: top; 
	      display: inline-block;
	   }
	   
	   #displayNameSpan {
	       font-size: 125%;
	   }
	   
	   #changeNameInput {
	      padding: 5px; 
		  width: 75%; 
		  margin-right: 2%; 
		  margin-left: 3%;
		  -webkit-border-radius: 5px;
		  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);
		  -moz-box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);
		  box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);			  
	   }
	   
	   #colorContainer {
	       width: 400px;
	   }
	   
	   .colorChangeContainer {
	      vertical-align: bottom;     
		  margin-left: -83px;
		  margin-bottom: -10px;
		  -webkit-margin-start: -103px;
	   }
	   
	   .colorSpanInput {
		   margin-right: -25px;
		   vertical-align: top;
	       display: inline;
		   margin-right: -5px;
	   }
	   
	   #colorChangeNameSpan {
	      font-size: 110%;
		  margin-left: -32px;
		  -webkit-margin-start: -32px;
	      padding-top: 20px;
		  -webkit-padding-before: 10px;
		  display: block;
	   }
	   
	   #colorChangeTextSpan {
	      font-size: 110%;
		  margin-left: -37px;
		  -webkit-margin-start: -37px;
	      padding-top: 20px;
		  -webkit-padding-before: 19px;
		  display: block;	       
	   }
	   
	   .hex {
	       font-size: 125%;
		   margin-right: -9px;
	   }
	   
	   .colorChangeInput {
	      display: inline-block;
		  padding: 5px; 
		  width: 70px; 
		  margin-right: 2%; 
		  margin-left: 3%;
		  -webkit-margin-after: -20px;
		  -webkit-border-radius: 5px;
		  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);
		  -moz-box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);
		  box-shadow: 0 0 1px rgba(0, 0, 0, 0.15);	      
	   }
	   
	   .colorPreview {
	       -webkit-margin-after: -9px;
	       padding-left: 5px; 
	       display: inline-block;
		   position: relative;
		   height: 28px;
		   width: 40px;
		   bottom: 0;
		   border-radius: 5px; 
		   -moz-border-radius: 5px; 
		   -webkit-border-radius: 5px;
	   }	   
	   
	   #changeAllSettingsButton {
		   display: block;
		   position: absolute;
		   bottom: 37px;
		   right: 30px;
		   
	       font: bold 12px/18px sans-serif;
		   display: inline-block;
		   margin-right: -4px;
		   padding: 8px 20px;
		   background: #fff;
		   cursor: pointer;	    
		   border: 1px solid rgba(100, 100, 100, 0.3);	
		   border-radius: 5px; 
		   -moz-border-radius: 5px; 
		   -webkit-border-radius: 5px;
		   -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);	   
	   }
	   
	   #changeAllSettingsButton:hover {
	      background: #eee;  
	   }
	   
	   #changeAllSettingsButton:active {
	      background: #ccc;  
	   }
	   
	   #messagesContainer {
	       position: absolute;
		   width: 100%;
		   overflow-y: auto;	
		   bottom: 45px;
		   top: 60px;
		   z-index: 5;
	   }
	   
	   #messages {	    
	       list-style-type: none; 
		   margin: 0; 
		   padding: 0; 
		   display: block;
		   z-index: 5;
	   }
	   
	   .msg { 
	       padding: 5px 10px; 
	   }
       .msg:nth-of-type(even) { 
	       background: #eee; 
		   z-index: 5;
	   }
	   .msg label {
	       color: #414163; 
		   font-weight: bold; 
		   padding-right: 25px; 
	   }
	   .msg span { 
	       color: #000; 
	   }
	   
	   .userLabel { 
	      padding-left: 80%; 
		  font-size: 10x; 
		  font-style: italic; 
	   }
	   
	   #messageFormContainer {
	       position: absolute;
		   bottom: 0;
	       width: 100%;
		   min-width: 1200px;
		   border-top: 1px solid #444;		   
	   }
	   
	   #messageForm {
	       position: relative;
	       background: #233F7E;  
		   padding: 3px;
	   }
	   
	   #messageInput {
	       width: 89%;
		   padding: 10px;
           margin-right: .5%; 
		   margin-left: 0.5%;		   
	   }
	   
	   #sendButton {
	       width: 8%;	   
	   	   font: bold 12px/18px sans-serif;
		   display: inline-block;
		   margin-right: -4px;
		   position: relative;
		   padding: 8px 10px;
		   background: #b3e7f1;
		   cursor: pointer;	    
		   border: 0;
		   border-radius: 5px; 
		   -moz-border-radius: 5px; 
		   -webkit-border-radius: 5px;
		   -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
		   box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);	 
	   }
	   
	   #sendButton:hover {
	      background: #a0e1ed;
	   }
	   #sendButton:active {
	      background: #8ddbea;
	   }	   
	   
	   #typingIndicatorContainer {
	       position: absolute;
		   width: 280px;
		   z-index: 40;
		   right: 20px;
		   bottom: 45px;
		   margin-bottom: 0px;
		   -webkit-margin-after: 1px;
	   }
	   
	   #typingIndicator {
	       list-style-type: none; 
		   margin: 0; 
		   padding: 0; 
		   display: block;	  
	   }
	   
	   [data-typing]:nth-child(1) {
	       border-top: 1px solid rgba(59, 86, 148, 0.3);
	   }
	   [data-typing] {
	       border-bottom: 1px solid rgba(59, 86, 148, 0.3);
		   border-left: 1px solid rgba(59, 86, 148, 0.3);
		   border-right: 1px solid rgba(59, 86, 148, 0.3);
	       padding: 1px 1px 1px 10px;
	       background: #c4ccde;
		   color: #FFF;
	   }
	   
	</style>
  </head>
  <body>
    <div id="typingIndicatorContainer">
	  <ul id="typingIndicator"></ul>
	</div>
    <div id="container">
	  <div id="shadow"></div> 	
      <div id="header">
	    <div id="circle"></div>
		<div id="nameBox">
		  <label id="connectText" class="noSelect">Connected as</label>
		  <label id="connectName" class="noSelect">&nbsp;</label>
		</div>	
		<ul id="moreUL">
		  <li id="moreLI" class="noSelect">
		    More
			<ul id="dropDown">
			  <div id="moreDropDown">
				 <div id="onlineContainer">
				   <span id="onlineUsersSpan" class="noSelect">Online Users</span>
				   <div id="onlineUsersScrollable">
				     <ul id="onlineUsers"></ul>
				   </div>
				 </div>
				<button id="settingsButton">Settings</button>
			  </div>
			</ul>
		  </li>
		</ul>
	  </div>
	  
	  <div id="settingsBox">
	    <div id="settingsContainer">
		   <div id="settingsHeader">
		     <label id="settingsLabel" class="noSelect">Settings</label>
		   </div>
		   <div id="nameChangeContainer">
		     <span id="displayNameSpan" class="noSelect">Display Name</span>
		     <input id="changeNameInput" autofocus autocomplete="off" />
		   </div>
		   <div id="colorContainer">
		   
		     <div id="colorNameChangeContainer" class="colorChangeContainer">
		       <div id="colorNameSpanInput" class="colorSpanInput">
			     <span id="colorChangeNameSpan" class="noSelect">Name Color</span>
			     <span class="hex">#</span><input id="colorChangeNameInput" class="colorChangeInput" maxlength="6" autocomplete="off" />
			   </div>
			   <div id="colorNamePreview" class="colorPreview"></div>
			 </div>  
			 
		     <div id="colorTextChangeContainer" class="colorChangeContainer">
		       <div id="colorTextSpanInput" class="colorSpanInput">
			     <span id="colorChangeTextSpan" class="noSelect">Text Color</span>
			     <span class="hex">#</span><input id="colorChangeTextInput" class="colorChangeInput" maxlength="6" autocomplete="off" />
			   </div>
			   <div id="colorTextPreview" class="colorPreview"></div>
			 </div>  
			 
		   </div>		  
           <button id="changeAllSettingsButton" class="regularButton">Apply</button>
		</div>
	  </div>	  
	  

   
      <div id="messageFormContainer">
      <form id="messageForm" action="">
        <input id="messageInput" autofocus autocomplete="off" /><button id="sendButton">Send</button>
      </form>	 
	  </div>
	</div>
	<div id="messagesContainer">
      <ul id="messages"></ul>
	</div>

	
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script type="text/javascript" language="javascript">
	    
		var socket = io();
		var clicks = 0;
		var darken = false;
	    var name = "";
		var messagesContainer = document.getElementById('messagesContainer');
		var connected = false;
		var nameColor = "414163";
		var textColor = "000000";
		var isTyping = false;
	
		//When you submit a message
		$('#messageForm').submit(function() {
		    //console.log(parseInt($('#typingIndicatorContainer').css('margin-bottom')) + 10);
			if(($('#messageInput').val() != '') && (connected)) {
				socket.emit('chat message', '<li class="msg"><label style="color:#'+nameColor+'">' + name + ':</label><span style="color:#'+textColor+'">' + $('#messageInput').val() + '</span></li>');		
				$('#messages').append($('<li class="msg">').append('<label style="color:#'+nameColor+'">' + name + ':</label><span style="color:#'+textColor+'">' + $('#messageInput').val() + '</span>'));
				$('#messageInput').val('');
				messagesContainer.scrollTop = messagesContainer.scrollHeight;		    
				socket.emit('is typing', "no");
			}
			return false;
		}); 
	
	    //Toggle the dropdown menu to display the online users/settings button
	    $('#moreLI').click(function() {
	        $('#dropDown').toggle();
	    });
	  
	    //Open the settings box
	    $('#settingsButton').click(function() {    
   	        $('#shadow').toggle();  
            $('#settingsBox').toggle();	
			$('#changeNameInput').focus();	 
			$('#changeNameInput').val(name);
			$('#colorChangeNameInput').val(nameColor);
			$('#colorNamePreview').css('background', '#' + nameColor);
			$('#colorChangeTextInput').val(textColor);
			$('#colorTextPreview').css('background', '#' + textColor);			
			clicks = 0;
			darken = true;
		});
	  
	    //Perform the steps to fully change your name if you changed it
	    function changeName() {
			var tempName = $('#changeNameInput').val();
			if(tempName != "") {
			    name = tempName;
				setCookie("name", name, 1);				
				if(connected) {
				    $('#connectName').text(name);								  
				    socket.emit('new display name', name);
				}
			}
		}
		
		//Check to see if it's a hex color
		function isHexColor(color) {
		   return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(color);
		}
		
		//Perform the steps to fully change a color if you changed it
		function changeColor(choice){
			var tempColor;
			if(choice == "Name")
		        tempColor = $('#colorChangeNameInput').val();
		    else
			    tempColor = $('#colorChangeTextInput').val();
				
			if(isHexColor("#" + tempColor)) {
			    if(choice == "Name") {
				    nameColor = tempColor;
					setCookie("nameColor", nameColor, 1);
				}
				else {
				    textColor = tempColor;
					setCookie("textColor", textColor, 1);
				}
			}
		}
	 
	    //Dynamically change the preview for the name color as you type valid hex colors
		$('#colorChangeNameInput').on('input', function() {
		    if(isHexColor("#" + $(this).val()))
			    $('#colorNamePreview').css('background', '#' + $(this).val());
		});
		//Dynamically change the preview for the text color as you type valid hex colors
		$('#colorChangeTextInput').on('input', function() {
		    if(isHexColor("#" + $(this).val()))
			    $('#colorTextPreview').css('background', '#' + $(this).val());
		});		
	  
	    //When you change some settings and click Apply
		$('#changeAllSettingsButton').click(function() {
			changeName();
			changeColor("Name");
			changeColor("Text");
			$('#shadow').toggle();  
			$('#settingsBox').toggle();
			$('#messageInput').focus();	 
			darken = false;		  
			
		});
		
		//Allows you to press enter on the change name box and it will click Apply
		$('#changeNameInput').keypress(function(e) {
			if(e.which == 13)
				$('#changeAllSettingsButton').click();
		});
		//Allows you to press enter on the change name color box and it will click Apply
		$('#colorChangeNameInput').keypress(function(e) {
			if(e.which == 13)
				$('#changeAllSettingsButton').click();
		});
		//Allows you to press enter on the change text color box and it will click Apply
		$('#colorChangeTextInput').keypress(function(e) {
			if(e.which == 13)
				$('#changeAllSettingsButton').click();
		});		
	  
	    //Remove the shadow when you click anywhere besides the settingsBox
	    $(document).on('click', function(event) {
			if(!$(event.target).closest('#settingsBox').length) {
				clicks++;
				if((clicks > 1) && (darken == true)) {
					$('#shadow').toggle();  
					$('#settingsBox').toggle();
					$('#messageInput').focus();	 
					darken = false;	
				}
			}
		});
		
		//For when a user is typing text/deleted all text (fire off typing identifier)
		$('#messageInput').on('input', function() {
		    if($(this).val().length > 0) {
			    if(!isTyping) {
			        isTyping = true;
					socket.emit('is typing', "yes");
				}
			}   
			else {
			    isTyping = false;
			    socket.emit('is typing', "no");
			}
		});
		
		
		//Get the values for the name and text colors from cookies
		function getColors() {
		    var tempNameCol = getCookie("nameColor");
			var tempTextCol = getCookie("textColor");
			
			if(tempNameCol != "")
			    nameColor = tempNameCol;
			if(tempTextCol != "")
			    textColor = tempTextCol;
		}
				
		//On page ready, set up name variable and connected users
		$( document ).ready(function() {
		    $('#connectText').text('Not connected');
			$('#connectName').text('____');
			getColors();
		});
	  
	  	//Handle the events needed for when you make connection with the server
		function connectionStart() {
		    $('#circle').css('background', '#00e500');
			$('#circle').css('border', '2px solid #00b200');			
			//Glow
			$('#circle').css('-webkit-box-shadow', '0 0 7px #0F0');
			$('#circle').css('-moz-box-shadow', '0 0 7px #0F0');
			$('#circle').css('box-shadow', '0 0 7px #0F0');
			
		    $('#connectText').text('Connected as');
			var tempName = getCookie("name");		  
			if(tempName != "") {
				name = tempName;
				socket.emit('have display name', name);
				$('#connectName').text(name);		
				socket.emit('need all connections', "pls");
			}	 
			else
				socket.emit('need guest name', "");		    
		}
		
		//Handle the events for if the server goes down
		function serverDisconnect() {
		    $('#circle').css('background', '#E60000');
			$('#circle').css('border', '2px solid #B20000');
			//Glow
			$('#circle').css('-webkit-box-shadow', '0 0 7px #F00');
			$('#circle').css('-moz-box-shadow', '0 0 7px #F00');
			$('#circle').css('box-shadow', '0 0 7px #F00');
			
		    $('#connectText').text('Not connected');
			$('#connectName').text('____');		
			$('#typingIndicator').empty();
			$('#onlineUsers').empty();
		}
		
		function removeIndividualTypingIndicator(user) {
		   	$('#typingIndicator li').each(function(index) {
			    if($(this).attr("data-id") == user.ID) {
				    $(this).remove();
				}
			});
		}
		  
		//------------Handle all socket identifiers ---------------------------------------------------
		//For handling the startup of a connection to the server
		socket.on('connect', function() {
		   connected = true;
		   connectionStart();
		});
		
		//For handling the server disconnecting
		socket.on('disconnect', function() {
			connected = false;		
			serverDisconnect();
		});
		
		//For gathering chat messages and displaying them
		socket.on('chat message', function(msg){
			$('#messages').append(msg);
			messagesContainer.scrollTop = messagesContainer.scrollHeight;
		});	
	  
		//For setting your name as a guest with a unique number (you haven't configured a name yet)
		socket.on('guest name', function(gName) {
			name = gName;
			$('#connectName').text(name);
			socket.emit('need all connections', "pls");
		});
	  
		//For getting newly connected users and appending their name to the online users list
		socket.on('connected user', function(name) {
			$('#onlineUsers').append($('<li>').text(name));
			$('#messages').append('<label class="userLabel">' + name + ' has connected<br></label>');
			messagesContainer.scrollTop = messagesContainer.scrollHeight;
		});
	  
		//For getting all the connected users at once to append to the online users list
		socket.on('all connections', function(names) {
			$('#onlineUsers').empty();
			for(var i=0; i<names.length; i++) {
				$('#onlineUsers').append($('<li>').text(names[i].Name));
			}
		});
	  
	    //For displaying to the chat when a user disconnects
		socket.on('disconnected user', function(user) {
			removeIndividualTypingIndicator(user);
			$('#messages').append('<label class="userLabel">' + user.Name + ' has disconnected<br></label>');
			messagesContainer.scrollTop = messagesContainer.scrollHeight;
		});
		
		//For displaying to the chat when a user is typing
		socket.on('typing', function(user) {
		    $('#typingIndicator').append('<li data-typing="yes" data-name="'+user.Name+'" data-id="'+user.ID+'">' + user.Name + ' is typing</li>');
		});
		
		//For removing '[user] is typing' li 
		socket.on('not typing', function(user) {
		    removeIndividualTypingIndicator(user);
		});
		//---------------------------------------------------------------------------------------------
		
		//Functions for cookies for storing your name  ------------------------------------------------
		function setCookie(cname, cvalue, exdays) {
			var d = new Date();
			d.setTime(d.getTime() + (exdays*24*60*60*1000));
			var expires = "expires="+d.toUTCString();
			document.cookie = cname + "=" + cvalue + "; " + expires;
		} 
	  
		function getCookie(cname) {
			var tname = cname + "=";
			var ca = document.cookie.split(';');
			for(var i=0; i<ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0)==' ') c = c.substring(1);
				if (c.indexOf(tname) == 0) return c.substring(tname.length, c.length);
			}
			return "";
		}
		//---------------------------------------------------------------------------------------------	  
	</script>
  </body>
</html>